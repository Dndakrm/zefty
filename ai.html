<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Zefty ID ‚Äî Ask AI</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: {50:'#eef8ff',100:'#d9efff',200:'#b8e0ff',300:'#8eccff',400:'#5ab2ff',500:'#2e97ff',600:'#1e77db',700:'#185fb0',800:'#154f90',900:'#143e70'},
          }
        }
      }
    }
  </script>
  <style>
    body { background:#0b142d; color:#fff; font-family: Inter, sans-serif; }
    .glass { backdrop-filter: blur(10px); background: rgba(255,255,255,.06); }
    .shadow-soft { box-shadow: 0 10px 30px rgba(0,0,0,.12); }
  </style>
</head>
<body class="flex flex-col min-h-screen">

  <!-- Header -->
  <header class="bg-[#0A1A3A]/80 backdrop-blur border-b border-white/10 px-4 py-3 flex items-center justify-between">
    <a href="index.html" class="flex items-center gap-3">
      <img src="https://i.imgur.com/dxE77jS.png" alt="Zefty ID" class="w-9 h-9 rounded-full ring-1 ring-white/20">
      <span class="text-xl font-bold">ZeFty ID</span>
    </a>
    <span class="opacity-70 text-sm">Ask AI (GPT-4o)</span>
  </header>

  <!-- Chat Section -->
  <main class="flex-1 flex flex-col max-w-3xl mx-auto w-full p-4">
    <div id="chatMsgs" class="flex-1 overflow-y-auto p-4 space-y-3 text-sm glass rounded-xl border border-white/10 shadow-soft">
      <div class="opacity-80">üëã Halo! Aku <b>Zefty AI</b>, powered by GPT-4o. Apa yang ingin kamu tanyakan?</div>
    </div>

    <form id="chatForm" class="mt-4 flex gap-2">
      <input id="chatInput" type="text" placeholder="Tulis pertanyaanmu..." 
             class="flex-1 px-4 py-3 rounded-xl glass border border-white/10 outline-none" />
      <button type="submit" class="px-5 py-3 rounded-xl bg-primary-600 hover:bg-primary-500 transition shadow-soft">
        Kirim
      </button>
    </form>
  </main>

  <!-- Footer -->
  <footer class="border-t border-white/10 bg-[#081530] px-4 py-3 text-center text-xs opacity-70">
    ¬© <span id="year"></span> Zefty ID ‚Äî Powered by GPT-4o
  </footer>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    const chatForm = document.getElementById('chatForm');
    const chatInput = document.getElementById('chatInput');
    const chatMsgs = document.getElementById('chatMsgs');

    function appendMsg(text, who='bot') {
      const wrap = document.createElement('div');
      wrap.className = `flex ${who==='user'?'justify-end':''}`;
      const bubble = document.createElement('div');
      bubble.className = `${who==='user'?'bg-primary-600':'glass'} max-w-[85%] px-3 py-2 rounded-2xl border border-white/10 whitespace-pre-wrap`;
      bubble.innerText = text;
      wrap.appendChild(bubble);
      chatMsgs.appendChild(wrap);
      chatMsgs.scrollTop = chatMsgs.scrollHeight;
    }

    async function askAI(q) {
      const res = await fetch('/api/chat', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ message: q })
      });
      if (!res.ok) { return "‚ö†Ô∏è Error koneksi ke server AI."; }
      const data = await res.json();
      return data.reply || "‚ö†Ô∏è Tidak ada jawaban.";
    }

    chatForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const q = chatInput.value.trim();
      if (!q) return;
      appendMsg(q, 'user');
      chatInput.value = '';
      appendMsg("‚è≥ Sedang mengetik...", 'bot');
      const reply = await askAI(q);
      chatMsgs.lastChild.remove(); // remove "Sedang mengetik"
      appendMsg(reply, 'bot');
    });
  </script>
</body>
</html>
